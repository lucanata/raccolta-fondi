<!DOCTYPE html>
<html>
<head>
<!--aggiungo per timer, funziona anche senza  -->
  <link rel="stylesheet" type="text/css" href="/app/assets/stylesheets/jquery.countdown.css"> 
  <script type="text/javascript" src="/app/assets/javascripts/jquery.countdown.js"></script>

</head>

<body>
<%- model_class = Campaign -%>
<div class="page-header">
  <h1><%=t '.title', :default => model_class.model_name.human.titleize %></h1>
</div>

<dl class="dl-horizontal">
  <dt><strong><%= model_class.human_attribute_name(:nome) %>:</strong></dt>
  <dd><%= @campaign.nome %></dd>
  <dt><strong><%= model_class.human_attribute_name(:descrizione) %>:</strong></dt>
  <dd><%= @campaign.descrizione %></dd>
  <dt><strong><%= model_class.human_attribute_name(:durata) %>:</strong></dt>
  <dd><%= @campaign.durata %></dd>
  <dt><strong><%= model_class.human_attribute_name(:goal) %>:</strong></dt>
  <dd><%= @campaign.goal %></dd>
  <dt><strong><%= model_class.human_attribute_name(:chiusa) %>:</strong></dt>
  <dd><%= @campaign.chiusa %></dd>
  <dt><strong><%= model_class.human_attribute_name(:user_id) %>:</strong></dt>
  <dd><%= @campaign.user_id %></dd>
  <dt><strong>Completamento: </strong></dt>
  <dd><%= @campaign.somma * 100 /@campaign.goal %> %</dd>
  <dd> Raccolti <%= @campaign.somma %> di <%= @campaign.goal %></dd>
  
  
</dl>

<%= progress_bar(@campaign.somma * 100 /@campaign.goal, :color =>'orange', :rounded => true) %>
<br></br>

 <dt><strong>La campagna scade tra: </strong></dt>
 <div id="countDownTimer"></div>
  <script> 
	var year = <%= @campaign.durata.year %>;
	var month = <%= @campaign.durata.month %>; 
	var day = <%= @campaign.durata.day %>; 
	var dealEndDate = new Date(); 
	dealEndDate = new Date(year, month - 1, day); 
	$('#countDownTimer').countdown({until: dealEndDate}); 
  </script>

<div class="form-actions">
  <% if can? :create, Bill %>
    <%= link_to "Versamento", new_campaign_bill_path(@campaign), :class => 'btn' %>  
  <% end %>

  <!--########################################################################## -->
  <% if (@campaign.user_id == current_user.id)  #da vedere come fare con cancan%>
    <%= link_to "Scopi", new_campaign_aim_path(@campaign), :class => 'btn' %> 
  <% end %>
  <!--########################################################################## -->

  <%= link_to t('.back', :default => t("helpers.links.back")),
              campaigns_path, :class => 'btn'  %>

  <% if can? :update, @campaign %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_campaign_path(@campaign), :class => 'btn' %>
  <% end %>

  <% if can? :destroy, @campaign %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              campaign_path(@campaign),
              :method => 'delete',
              :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')) },
              :class => 'btn btn-danger' %>
  <% end %>
</div>

<% if (@campaign.user_id == current_user.id) %>
  <%= render :partial => 'details' %>
<% end %>

</body>
</html>
